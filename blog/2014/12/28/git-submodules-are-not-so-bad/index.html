<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">


        <title>git submodules are not so bad</title>

            <link href="https://mindriot101.github.io/feeds/all.xml" type="application/atom+xml" rel="alternate" title="circularspace Full Atom Feed" />
            <link href="https://mindriot101.github.io/feeds/tech.xml" type="application/atom+xml" rel="alternate" title="circularspace Categories Atom Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="https://mindriot101.github.io/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="https://mindriot101.github.io/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="https://mindriot101.github.io/theme/css/code_blocks/monokai.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="I see a lot of complaints about git submodules, people suggesting alternatives, complaints about merging or other bits and pieces. Git ...">

        <meta name="author" content="Simon Walker">

        <meta name="tags" content="git">

	                <meta property="og:locale" content="">
		<meta property="og:site_name" content="circularspace">

	<meta property="og:type" content="article">
            <meta property="article:author" content="https://mindriot101.github.io/author/simon-walker.html">
	<meta property="og:url" content="https://mindriot101.github.io/blog/2014/12/28/git-submodules-are-not-so-bad/">
	<meta property="og:title" content="git submodules are not so bad">
	<meta property="article:published_time" content="2014-12-28 23:25:51+00:00">
            <meta property="og:description" content="I see a lot of complaints about git submodules, people suggesting alternatives, complaints about merging or other bits and pieces. Git ...">

            <meta property="og:image" content="https://mindriot101.github.io/theme/images/post-bg.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@srwalker101">
        <meta name="twitter:title" content="git submodules are not so bad">

            <meta name="twitter:image" content="https://mindriot101.github.io/theme/images/post-bg.jpg">

            <meta name="twitter:description" content="I see a lot of complaints about git submodules, people suggesting alternatives, complaints about merging or other bits and pieces. Git ...">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://mindriot101.github.io/">circularspace</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                        <li><a href="/archives.html">all</a></li>

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-color: #444">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>git submodules are not so bad</h1>
                        <span class="meta">Posted by
                                <a href="https://mindriot101.github.io/author/simon-walker.html">Simon Walker</a>
                             on Sun 28 December 2014
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>I see a lot of complaints about git submodules, <a href="https://blogs.atlassian.com/2013/05/alternatives-to-git-submodule-git-subtree/">people suggesting alternatives</a>, <a href="https://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules/">complaints about merging</a> or other bits and pieces.</p>
<p>Git submodules <em>have their place</em>. Yes they are not ideal for all situations but they are ideal for the typical use case I'm about to outline.</p>
<h2>Example use case</h2>
<p>In my work I have a <em>master</em> project which contains multiple submodules. Each submodule is also cloned into a separate <em>development</em> repository sitting near by. I use the <em>master</em> repository to synchronise pushes to the deployment server (in this case an isolated computer sitting on a mountain in Chile!)</p>
<p>Admittedly I have to train myself to follow certain procedures:</p>
<ol>
<li>
<p><em>Never</em> perform code alterations or general development in the submodule inside the <em>master</em> repository.</p>
</li>
<li>
<p>Only use the <em>master</em> repository for synchronisation.</p>
</li>
</ol>
<h2>Git submodule advantages</h2>
<p>For my use case I find it very good for the <em>master</em> repository to track a single <em>commit</em>, as this bakes in the state of the submodules for each commit of the <em>master</em> repository. I only need to record the git sha of the <em>master</em> to be able to recreate the entire source code checkout of the individual packages.</p>
<p>Development on the individual packages is also easier as they're modularised into separate small, testable directories, and only combined in the <em>master</em> during a "deployment".</p>
<p>I can add tests to the <em>master</em> project that assess the integration between submodules. In the case of an error I can then check out a specific revision in my submodules at will to re-run tests and find breaking changes, perhaps with <code>git bisect</code>.</p>
<h2>Git submodule disadvantages</h2>
<p>The paradigm shift of using submodules is a pain. They require extra, very strange commands to synchronise.</p>
<p>I have a few git aliases to help me with this:</p>
<div class="highlight"><pre>su = submodule update --init --recursive
</pre></div>


<p>This command initialises and synchronises the submodules in whatever state they started in, either not existing - so a clone takes place - or a previous commit. It also synchronises nested submodules, which I'll admit I would probably never do.</p>
<div class="highlight"><pre>upsub = submodule foreach &#39;git checkout master &amp;&amp; git pull&#39;
</pre></div>


<p>A very useful command, <code>git submodule foreach</code> runs a command over every submodule specified in the current project. In this case it's used to update the master branch to <code>origin</code>.</p>
<p>A minor annoyance is a submodule with code changes will appear to a git status in the <em>master</em> as an untracked file, showing the whole submodule as <em>modified</em>. I personally like this feature as it reminds me that the submodule in the <em>master</em> is not in a proper state:</p>
<div class="highlight"><pre>-Subproject commit c74dd1e56794962d7ff7661a7f8ae84cafa96b4f
+Subproject commit c74dd1e56794962d7ff7661a7f8ae84cafa96b4f-dirty
</pre></div>


<p>and therefore shouts at me for forgetting rule 1. above. It can be disabled via: <code>git status --ignore-submodules=dirty</code> but I do not recommend this. Consider it a <em>feature</em>.</p>
<h2>Git subtree</h2>
<p>A common suggested alternative is <a href="https://git-scm.com/book/en/v1/Git-Tools-Subtree-Merging">git subtree</a> which I have tried, though briefly. Perhaps learning submodules from an early stage has ingrained their process in my brain too hard for other alternatives to really show their benefits. As far as I could tell <code>git subtree</code> creates a huge merge commit in the master repository as a single static blob. I didn't look into coding in the subtrees but I feel the separation of projects afforded by submodules fits my needs better. Perhaps I just have to read the linked article above a bit more.</p>
<h2>Hints and tips</h2>
<p>Some hints and tips I always have to google myself:</p>
<h3>Remove a submodule</h3>
<p><a href="https://stackoverflow.com/a/16162000/56711">source</a></p>
<div class="highlight"><pre>git submodule deinit asubmodule
git rm asubmodule
</pre></div>


<h2>Summary</h2>
<ul>
<li>Separate projects and use a <em>master</em> project to coordinate commits,</li>
<li><em>Never</em> develop in the <em>master</em>s copy of the repository,</li>
<li>Use shortcuts to make managing submodules easier.</li>
</ul>
    </article>

        <div class="tags">
            <p>tags: <a href="https://mindriot101.github.io/tag/git.html">git</a></p>
        </div>

    <hr>

            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/srwalker101">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/mindriot101">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="https://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="https://python.org">Python</a>. <br />        &copy;  Simon Walker
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="https://mindriot101.github.io/theme/js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://mindriot101.github.io/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="https://mindriot101.github.io/theme/js/clean-blog.min.js"></script>

</body>

</html>