<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>git submodules are not so bad - circularspace</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blog.simonrw.com/blog/2014/12/28/git-submodules-are-not-so-bad/">

        <meta name="author" content="Simon Walker" />
        <meta name="keywords" content="git" />
        <meta name="description" content="I see a lot of complaints about git submodules, people suggesting alternatives, complaints about merging or other bits and pieces. Git submodules have their place. Yes they are not ideal for all situations but they are ideal for the typical use case I&#39;m about to outline. Example use case ..." />

        <meta property="og:site_name" content="circularspace" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="git submodules are not so bad"/>
        <meta property="og:url" content="https://blog.simonrw.com/blog/2014/12/28/git-submodules-are-not-so-bad/"/>
        <meta property="og:description" content="I see a lot of complaints about git submodules, people suggesting alternatives, complaints about merging or other bits and pieces. Git submodules have their place. Yes they are not ideal for all situations but they are ideal for the typical use case I&#39;m about to outline. Example use case ..."/>
        <meta property="article:published_time" content="2014-12-28" />
            <meta property="article:section" content="tech" />
            <meta property="article:tag" content="git" />
            <meta property="article:author" content="Simon Walker" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.simonrw.com/theme/css/bootstrap.readable.min.css" type="text/css"/>
    <link href="https://blog.simonrw.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.simonrw.com/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.simonrw.com/theme/css/style.css" type="text/css"/>

        <link href="https://blog.simonrw.com/feeds/all.xml" type="application/atom+xml" rel="alternate"
              title="circularspace ATOM Feed"/>



        <link href="https://blog.simonrw.com/feeds/tech.xml" type="application/atom+xml" rel="alternate"
              title="circularspace tech ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.simonrw.com/" class="navbar-brand">
circularspace            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/archives.html">all</a></li>
                        <li >
                            <a href="https://blog.simonrw.com/category/gaming.html">Gaming</a>
                        </li>
                        <li >
                            <a href="https://blog.simonrw.com/category/life.html">Life</a>
                        </li>
                        <li >
                            <a href="https://blog.simonrw.com/category/science.html">Science</a>
                        </li>
                        <li class="active">
                            <a href="https://blog.simonrw.com/category/tech.html">Tech</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://blog.simonrw.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blog.simonrw.com/blog/2014/12/28/git-submodules-are-not-so-bad/"
                       rel="bookmark"
                       title="Permalink to git submodules are not so bad">
                        git submodules are not so bad
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-12-28T23:25:51+00:00"> Sun 28 December 2014</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://blog.simonrw.com/tag/git.html">git</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>I see a lot of complaints about git submodules, <a href="http://blogs.atlassian.com/2013/05/alternatives-to-git-submodule-git-subtree/">people suggesting alternatives</a>, <a href="https://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules/">complaints about merging</a> or other bits and pieces.</p>
<p>Git submodules <em>have their place</em>. Yes they are not ideal for all situations but they are ideal for the typical use case I'm about to outline.</p>
<h2>Example use case</h2>
<p>In my work I have a <em>master</em> project which contains multiple submodules. Each submodule is also cloned into a separate <em>development</em> repository sitting near by. I use the <em>master</em> repository to synchronise pushes to the deployment server (in this case an isolated computer sitting on a mountain in Chile!)</p>
<p>Admittedly I have to train myself to follow certain procedures:</p>
<ol>
<li>
<p><em>Never</em> perform code alterations or general development in the submodule inside the <em>master</em> repository.</p>
</li>
<li>
<p>Only use the <em>master</em> repository for synchronisation.</p>
</li>
</ol>
<h2>Git submodule advantages</h2>
<p>For my use case I find it very good for the <em>master</em> repository to track a single <em>commit</em>, as this bakes in the state of the submodules for each commit of the <em>master</em> repository. I only need to record the git sha of the <em>master</em> to be able to recreate the entire source code checkout of the individual packages.</p>
<p>Development on the individual packages is also easier as they're modularised into separate small, testable directories, and only combined in the <em>master</em> during a "deployment".</p>
<p>I can add tests to the <em>master</em> project that assess the integration between submodules. In the case of an error I can then check out a specific revision in my submodules at will to re-run tests and find breaking changes, perhaps with <code>git bisect</code>.</p>
<h2>Git submodule disadvantages</h2>
<p>The paradigm shift of using submodules is a pain. They require extra, very strange commands to synchronise.</p>
<p>I have a few git aliases to help me with this:</p>
<div class="highlight"><pre>su = submodule update --init --recursive
</pre></div>


<p>This command initialises and synchronises the submodules in whatever state they started in, either not existing - so a clone takes place - or a previous commit. It also synchronises nested submodules, which I'll admit I would probably never do.</p>
<div class="highlight"><pre>upsub = submodule foreach &#39;git checkout master &amp;&amp; git pull&#39;
</pre></div>


<p>A very useful command, <code>git submodule foreach</code> runs a command over every submodule specified in the current project. In this case it's used to update the master branch to <code>origin</code>.</p>
<p>A minor annoyance is a submodule with code changes will appear to a git status in the <em>master</em> as an untracked file, showing the whole submodule as <em>modified</em>. I personally like this feature as it reminds me that the submodule in the <em>master</em> is not in a proper state:</p>
<div class="highlight"><pre>-Subproject commit c74dd1e56794962d7ff7661a7f8ae84cafa96b4f
+Subproject commit c74dd1e56794962d7ff7661a7f8ae84cafa96b4f-dirty
</pre></div>


<p>and therefore shouts at me for forgetting rule 1. above. It can be disabled via: <code>git status --ignore-submodules=dirty</code> but I do not recommend this. Consider it a <em>feature</em>.</p>
<h2>Git subtree</h2>
<p>A common suggested alternative is <a href="http://git-scm.com/book/en/v1/Git-Tools-Subtree-Merging">git subtree</a> which I have tried, though briefly. Perhaps learning submodules from an early stage has ingrained their process in my brain too hard for other alternatives to really show their benefits. As far as I could tell <code>git subtree</code> creates a huge merge commit in the master repository as a single static blob. I didn't look into coding in the subtrees but I feel the separation of projects afforded by submodules fits my needs better. Perhaps I just have to read the linked article above a bit more.</p>
<h2>Hints and tips</h2>
<p>Some hints and tips I always have to google myself:</p>
<h3>Remove a submodule</h3>
<p><a href="http://stackoverflow.com/a/16162000/56711">source</a></p>
<div class="highlight"><pre>git submodule deinit asubmodule
git rm asubmodule
</pre></div>


<h2>Summary</h2>
<ul>
<li>Separate projects and use a <em>master</em> project to coordinate commits,</li>
<li><em>Never</em> develop in the <em>master</em>s copy of the repository,</li>
<li>Use shortcuts to make managing submodules easier.</li>
</ul>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://twitter.com/srwalker101"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
                <li class="list-group-item"><a href="https://github.com/mindriot101"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://mindriot101.github.io/cv/" target="_blank">
                CV
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www2.warwick.ac.uk/fac/sci/physics/research/astro/people/walker/" target="_blank">
                Work
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Simon Walker
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.simonrw.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.simonrw.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.simonrw.com/theme/js/respond.min.js"></script>


</body>
</html>