<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>circularspace</title><link href="https://blog.simonrw.com/" rel="alternate"></link><link href="https://blog.simonrw.com/feeds/tag_numpy.xml" rel="self"></link><id>https://blog.simonrw.com/</id><updated>2016-05-06T09:42:56+01:00</updated><entry><title>Numpy functions may not do what you think</title><link href="https://blog.simonrw.com/blog/2016/05/06/numpy-functions-may-not-do-what-you-think/" rel="alternate"></link><updated>2016-05-06T09:42:56+01:00</updated><author><name>Simon Walker</name></author><id>tag:blog.simonrw.com,2016-05-06:blog/2016/05/06/numpy-functions-may-not-do-what-you-think/</id><summary type="html">&lt;p&gt;Numpy has the ability to mask arrays and ignore their values for certain computations, called "masked arrays". They contain a &lt;code&gt;.mask&lt;/code&gt; attribute which is a boolean array, &lt;code&gt;True&lt;/code&gt; where the value should be masked and &lt;code&gt;False&lt;/code&gt; otherwise.&lt;/p&gt;
&lt;p&gt;Numpy also comes with a suite of functions which can handle this masking naturally. Typically for a function in the &lt;code&gt;np.&lt;/code&gt; namespace, there is a masked-array-aware version under the &lt;code&gt;np.ma.&lt;/code&gt; namespace:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;np.median  =&amp;gt; np.ma.median
np.average =&amp;gt; np.ma.average
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A crucial thing to remember however is that &lt;strong&gt;standard &lt;code&gt;numpy&lt;/code&gt; functions ignore the mask for a masked array&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;This caught me out when sigma clipping values using &lt;code&gt;astropy.stats.sigma_clip&lt;/code&gt; - which masks out values outside the sigma range. To ignore the sigma clipped values I should have used &lt;code&gt;np.ma.median&lt;/code&gt; instead of &lt;code&gt;np.median&lt;/code&gt;.&lt;/p&gt;</summary><category term="python"></category><category term="numpy"></category></entry></feed>