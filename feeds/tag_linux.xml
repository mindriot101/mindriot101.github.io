<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>circularspace</title><link href="https://mindriot101.github.io/" rel="alternate"></link><link href="https://mindriot101.github.io/feeds/tag_linux.xml" rel="self"></link><id>https://mindriot101.github.io/</id><updated>2020-03-21T19:04:41+00:00</updated><entry><title>Linux debugging tips</title><link href="https://mindriot101.github.io/blog/2020/03/21/linux-debugging-tips/" rel="alternate"></link><updated>2020-03-21T19:04:41+00:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2020-03-21:blog/2020/03/21/linux-debugging-tips/</id><summary type="html">&lt;p&gt;&lt;em&gt;&lt;strong&gt;üìò  üíª ‚ÑπÔ∏è These tips are designed to help new Linux users work out what is going on.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Finding out what process is listening on a port&lt;/h2&gt;
&lt;p&gt;This is most common for web servers. When a web server listens on a specific
port (e.g. 5000 for Flask's default port), it is often useful to know more
information about this process. In particular, only one process can listen on a
port at once. If your program doesn't start because another process is
listening, then this will be useful for you.&lt;/p&gt;
&lt;h3&gt;Problem example&lt;/h3&gt;
&lt;p&gt;In the example below I have started a Flask web server on port 5000. I try to
start another server and get the following error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;OSError: [Errno 48] Address already in use
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This is because another process is listening on that port. In order to find out
what that process is, I run &lt;code&gt;lsof&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Solution&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;lsof&lt;/code&gt; &lt;strong&gt;l&lt;/strong&gt;i&lt;strong&gt;s&lt;/strong&gt;ts &lt;strong&gt;o&lt;/strong&gt;pen &lt;strong&gt;f&lt;/strong&gt;iles. On Linux, &lt;em&gt;everything&lt;/em&gt; is a file, so
this includes ports. In order to check for ports, use the &lt;code&gt;-i&lt;/code&gt; flag and define
the port as &lt;code&gt;:&amp;lt;port&amp;gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;lsof -i :5000

COMMAND    PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
flask   &lt;span class="m"&gt;142550&lt;/span&gt; simon    3u  IPv4 &lt;span class="m"&gt;978282&lt;/span&gt;      0t0  TCP localhost:commplex-main &lt;span class="o"&gt;(&lt;/span&gt;LISTEN&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This shows that process &lt;code&gt;142550&lt;/code&gt; (&lt;code&gt;PID&lt;/code&gt; column) is responsible for listening on
this port.&lt;/p&gt;
&lt;h2&gt;Getting information about a process&lt;/h2&gt;
&lt;p&gt;In the example above, we found out that process 142550 is listening on port 5000.
What if we want to find more information about this process? For example, where
the program was started from, what command is being run?&lt;/p&gt;
&lt;h3&gt;The &lt;code&gt;/proc&lt;/code&gt; filesystem&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Note: the program &lt;code&gt;ps&lt;/code&gt; can do quite a lot of this&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Linux stores information about all of the running processes on the system under
&lt;code&gt;/proc&lt;/code&gt;. At the top level is one directory per process, so we find the path
&lt;code&gt;/proc/142550&lt;/code&gt; exists:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;ls /proc &lt;span class="p"&gt;|&lt;/span&gt; grep 142550

142550
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Inside this filesystem is a host of useful information:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;ls /proc/142550

total 0
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 arch_status
dr-xr-xr-x  &lt;span class="m"&gt;2&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 attr
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 autogroup
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 auxv
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 cgroup
--w-------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 clear_refs
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:18 cmdline
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 comm
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 coredump_filter
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 cpuset
lrwxrwxrwx  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 cwd -&amp;gt; /tmp/flasktesting
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 environ
lrwxrwxrwx  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:18 exe -&amp;gt; /usr/bin/python3.8
dr-x------  &lt;span class="m"&gt;2&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:18 fd
dr-x------  &lt;span class="m"&gt;2&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:18 fdinfo
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 gid_map
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 io
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 latency
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 limits
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 loginuid
dr-x------  &lt;span class="m"&gt;2&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 map_files
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 maps
-rw-------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 mem
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 mountinfo
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 mounts
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 mountstats
dr-xr-xr-x &lt;span class="m"&gt;62&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 net
dr-x--x--x  &lt;span class="m"&gt;2&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 ns
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 numa_maps
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 oom_adj
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 oom_score
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 oom_score_adj
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 pagemap
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 personality
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 projid_map
lrwxrwxrwx  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 root -&amp;gt; /
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 sched
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 schedstat
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 sessionid
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 setgroups
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 smaps
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 smaps_rollup
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 stack
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:18 stat
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 statm
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:19 status
-r--------  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 syscall
dr-xr-xr-x  &lt;span class="m"&gt;3&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 task
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 timers
-rw-rw-rw-  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 timerslack_ns
-rw-r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 uid_map
-r--r--r--  &lt;span class="m"&gt;1&lt;/span&gt; simon simon &lt;span class="m"&gt;0&lt;/span&gt; Mar &lt;span class="m"&gt;21&lt;/span&gt; 20:22 wchan
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Some interesting entries:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cwd&lt;/code&gt;: a symlink to the directory the process was started from&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cmdline&lt;/code&gt;: a file listing the full command running (strings separated by the
  &lt;code&gt;null&lt;/code&gt; byte &lt;code&gt;\0&lt;/code&gt; rather than newlines)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;environ&lt;/code&gt;: a file listing the process environment variables when the program
  was run (strings separated by the &lt;code&gt;null&lt;/code&gt; byte &lt;code&gt;\0&lt;/code&gt; rather than newlines)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fd&lt;/code&gt;: a directory containing one entry for each file the process has open&lt;/li&gt;
&lt;li&gt;&lt;code&gt;exe&lt;/code&gt;: a symlink to the process running (note for Python apps this will link to
  the python interpreter)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mountinfo&lt;/code&gt;: list the mount points that the process can see (interesting for
  docker containers)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A process can investigate its &lt;em&gt;own&lt;/em&gt; information by looking at the symlink
&lt;code&gt;/proc/self&lt;/code&gt; which points to its own &lt;code&gt;/proc&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;An alternative way of getting the process arguments is to run&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;ps -p &amp;lt;pid&amp;gt; -o args

COMMAND
/usr/bin/python /usr/bin/flask run
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a href="http://man7.org/linux/man-pages/man5/proc.5.html"&gt;More information about the &lt;code&gt;/proc&lt;/code&gt;
filesystem&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Find out what system calls a process is running currently&lt;/h2&gt;
&lt;p&gt;Linux operates at two levels: &lt;em&gt;userspace&lt;/em&gt; and &lt;em&gt;kernel&lt;/em&gt;. Normal programs are not
allowed to talk to files or memory directly, they must ask the kernel through
&lt;em&gt;system calls&lt;/em&gt;. &lt;code&gt;strace&lt;/code&gt; is a program that lets a normal user spy on what a
&lt;em&gt;userspace&lt;/em&gt; program is asking the kernel to do. This may be useful for example
if a program is stuck. You can try to see if it is stuck talking to the network,
or talking to the file system, or stuck in a wait loop.&lt;/p&gt;
&lt;p&gt;For more information, check out &lt;a href="https://jvns.ca/categories/strace/"&gt;Julia Evans' blog
posts&lt;/a&gt; on &lt;code&gt;strace&lt;/code&gt; and its power.&lt;/p&gt;</summary><category term="linux"></category></entry><entry><title>Making windows feel more like Linux</title><link href="https://mindriot101.github.io/blog/2018/07/03/making-windows-feel-more-like-linux/" rel="alternate"></link><updated>2018-07-03T20:22:23+01:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2018-07-03:blog/2018/07/03/making-windows-feel-more-like-linux/</id><summary type="html">&lt;p&gt;&lt;em&gt;I haven't posted for a while, and this is not going to be a very useful
post, you have been warned...&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;At work we use Windows. I vowed when I left my last job that I'd never
go to work somewhere that uses Windows.&lt;/p&gt;
&lt;p&gt;I am very much still not a fan, especially since I have not got admin
rights and we are using Windows 8 - one of the most hated versions of
Windows since ME.&lt;/p&gt;
&lt;p&gt;I have been using Linux personally and professionaly for a decade now, and am so optimised to live on the command line that Windows is
genuinely slowing me down at work.&lt;/p&gt;
&lt;p&gt;There are a few programs that help with this. They do not recreate my
life on the command line as before, but they help with general
behaviours.&lt;/p&gt;
&lt;h1&gt;Mouse-dragging of windows&lt;/h1&gt;
&lt;p&gt;Most Linux desktop environments support dragging a window by holding Alt
and dragging with the left mouse button. Additionally, some of them
support resizing windows by holding alt and dragging with the right
mouse button.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://stefansundin.github.io/altdrag/"&gt;AltDrag&lt;/a&gt; is the program that
provides this functionality for Windows.&lt;/p&gt;
&lt;h1&gt;Scrolling the inactive window&lt;/h1&gt;
&lt;p&gt;In Linux, scrolling the mouse wheel over an inactive window scrolls the
content. This does not happen on Windows, at least Windows 8.&lt;/p&gt;
&lt;p&gt;Again, &lt;a href="https://stefansundin.github.io/altdrag/"&gt;AltDrag&lt;/a&gt; provides this
functionality and is crucial when for example, writing some notes on a
webpage and scrolling the page without selecting the web browser.&lt;/p&gt;
&lt;h1&gt;Task launcher&lt;/h1&gt;
&lt;p&gt;The Windows 8 search functionality for programs is abysmal. Compared to
the lightning pace of life when on the command line, the Windows 8
search box performance is terrible.&lt;/p&gt;
&lt;p&gt;If it's accuracy were perfect, I'd try to put up with the terrible
performance, but it also is not.&lt;/p&gt;
&lt;p&gt;I switched to &lt;a href="http://executor.dk/"&gt;Executor&lt;/a&gt; which I've bound to the
Spotlight-default Alt+Space. It starts instantly, looks great, and finds
programs very well.&lt;/p&gt;
&lt;h1&gt;Vimium&lt;/h1&gt;
&lt;p&gt;This is actually a feature that I use in Linux as well. Given I use
&lt;a href="https://www.vim.org"&gt;Vim&lt;/a&gt; as my text editor, I am so acustomed to the
key bindings and modal editing in general, I strive to use Vim
keybindings everywhere.&lt;/p&gt;
&lt;p&gt;I have tried many Vim shortcut plugins for my web browser over the
years, and &lt;a href="https://vimium.github.io/"&gt;Vimium&lt;/a&gt; is the best I've found.
Since Firefox switched to WebExtensions, this plugin has worked with
Firefox reinforcing my opinion that Firefox is my favourite browser.&lt;/p&gt;
&lt;h1&gt;Keyboard shortcuts&lt;/h1&gt;
&lt;p&gt;Part of living life on the command line is never using the mouse.
Windows has some general keyboard shortcuts that can help, and some
programs have shortcuts that help.&lt;/p&gt;
&lt;h1&gt;Text editors&lt;/h1&gt;
&lt;p&gt;Luckily for me, my text editor of choice &lt;a href="https://www.vim.org"&gt;Vim&lt;/a&gt; is
supported on Windows, as is &lt;a href="https://neovim.io/"&gt;Neovim&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I am also having good success using &lt;a href="https://code.visualstudio.com/"&gt;Visual Studio
Code&lt;/a&gt; - with &lt;a href="https://marketplace.visualstudio.com/items?itemName=vscodevim.vim"&gt;Vim
keybindings&lt;/a&gt;,
including true Neovim integration. The plugin ecosystem is excellent.&lt;/p&gt;
&lt;h1&gt;Portable apps&lt;/h1&gt;
&lt;p&gt;This is not really a program that makes Windows feel more like Linux,
but it does help getting around the lack of admin rights.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://portableapps.com/"&gt;Portable Apps&lt;/a&gt; are a way to run quote a lot
of Windows programs without "proper" installation. I presume this means
they do not need to set registry keys&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt; etc. This way I can have my
text editor, a decent web browser and a few other programs.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;don't get me started on a global binary method of storing
  configuration, rather than simple plain-text scripts in standard
  locations...&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary><category term="windows"></category><category term="linux"></category></entry><entry><title>Command line inconsistency</title><link href="https://mindriot101.github.io/blog/2016/03/09/command-line-inconsistency/" rel="alternate"></link><updated>2016-03-09T15:20:14+00:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2016-03-09:blog/2016/03/09/command-line-inconsistency/</id><summary type="html">&lt;h2&gt;RTFM!&lt;/h2&gt;
&lt;p&gt;Today I brought down our head node at work, because of a
misunderstanding of command line arguments for a linux program.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In fairness, I should have read the man page more carefully for the
entry in question!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I was using xargs for some nice command line parallelism and process
running. The command I ran was:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ls &lt;span class="p"&gt;|&lt;/span&gt; grep action119 &lt;span class="p"&gt;|&lt;/span&gt; grep exposureCycle &lt;span class="p"&gt;|&lt;/span&gt; xargs -n &lt;span class="m"&gt;1&lt;/span&gt; -I &lt;span class="o"&gt;{}&lt;/span&gt; find &lt;span class="o"&gt;{}&lt;/span&gt; -name &lt;span class="s1"&gt;&amp;#39;IMAGE*.fits&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; xargs -n &lt;span class="m"&gt;1&lt;/span&gt; -P &lt;span class="m"&gt;0&lt;/span&gt; bzip2 -k
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In summary this finds the directories containing "action119" and
"exposureCycle" in the current directory, finds all of the files called
&lt;code&gt;IMAGE*.fits&lt;/code&gt; in each directory and then in parallel compresses them
while keeping the original file (&lt;code&gt;-k&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;code&gt;xargs&lt;/code&gt; is used twice in this invocation, and is one of my new favourite
tools. It takes a multi-line input on stdin, and passes each line to
whatever command that follows, e.g.:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ls &lt;span class="p"&gt;|&lt;/span&gt; xargs &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;is the same as&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ls &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read &lt;/span&gt;filename&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$filename&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="c"&gt;# or&lt;/span&gt;
&lt;span class="c"&gt;# for file in $(ls); do echo $filename; done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It just dumps the input on the end of the command that follows &lt;code&gt;xargs&lt;/code&gt;.
The argument &lt;code&gt;-n&lt;/code&gt; says run the following command for each line on the
input, otherwise it dumps them all[1] on the end of the command. &lt;code&gt;-I {}&lt;/code&gt;
replaces all occurrences of &lt;code&gt;{}&lt;/code&gt; in the command with the input argument.&lt;/p&gt;
&lt;p&gt;The first xargs invocation runs &lt;code&gt;find&lt;/code&gt; for each directory, which then
prints a long list of files. The second xargs invocation bzips the files
in parallel, whilst keeping the original.&lt;/p&gt;
&lt;p&gt;The key error was the &lt;code&gt;-P&lt;/code&gt; argument. From the man page:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;--max-procs=max-procs
-P max-procs
    Run up to max-procs processes at a time; the default is 1.  If
    max-procs is 0, xargs will run as many processes as possible at a
    time.  Use the -n option with -P; otherwise chances are that only
    one exec will be done.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In other linux programs I've used (e.g. GNU parallel) specifying &lt;code&gt;0&lt;/code&gt; for
the number of processes means run the same as the number of processors
on the machine. For xargs, importantly it says "run as many processes as
possible", pretty much meaning one per input file.&lt;/p&gt;
&lt;p&gt;I expected 16 processes to be spawned, one for each (virtual) core. It
spawned ~5k processes one per input file.&lt;/p&gt;
&lt;p&gt;It brought the system down for about an hour, but it did seem to recover
ok.&lt;/p&gt;
&lt;p&gt;In conclusion: &lt;strong&gt;RTFM!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;[1] actually because of linux command length restrictions, it splits the
lines up to follow this limitation, and runs the command multiple times
in groups if need be&lt;/em&gt;&lt;/p&gt;</summary><category term="linux"></category></entry><entry><title>Tiling png images in linux</title><link href="https://mindriot101.github.io/blog/2014/06/26/tiling-png-images-in-linux/" rel="alternate"></link><updated>2014-06-26T16:25:31+01:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2014-06-26:blog/2014/06/26/tiling-png-images-in-linux/</id><summary type="html">&lt;p&gt;For printing multiple images, it's usually handy to tile images so that more than one page fits on a piece of paper at once. This can be achieved with ImageMagick and the &lt;code&gt;montage&lt;/code&gt; command.&lt;/p&gt;
&lt;h3&gt;Building a tiled image&lt;/h3&gt;
&lt;p&gt;For a 2x2 image an example command is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;montage -tile 2x2 -geometry 1600x1200 1.png 2.png 3.png 4.png output.png
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;em&gt;Be careful with the output specification, as if you forget it it'll overwrite the last png in the list.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This command produces a 1600x1200 sized image with 4 pngs arranged in a 2x2 grid. For more options see the man pages.&lt;/p&gt;</summary><category term="linux"></category></entry><entry><title>Mac keyboard keys with Synergy</title><link href="https://mindriot101.github.io/blog/2012/08/06/mac-keyboard-keys-with-synergy/" rel="alternate"></link><updated>2012-08-06T17:21:28+02:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2012-08-06:blog/2012/08/06/mac-keyboard-keys-with-synergy/</id><summary type="html">&lt;p&gt;Synergy is a great program to control multiple computers from a single keyboard or mouse even without them being plugged in. The only requirement is that theyre on the same local network.&lt;/p&gt;
&lt;p&gt;Im sharing my configuration which has my windows desktop as the server, and my macbook as the client. Using a windows keyboard creates some issues with the macbook, so here are the settings I use to map the keys correctly:&lt;/p&gt;
&lt;p&gt;Shift - Shift
Ctrl - Ctrl
Alt - Meta
Meta - Meta
Super - Alt
Also I use the fix CAPSLOCK key setting.&lt;/p&gt;
&lt;p&gt;This gives the same control layout as my mac (ie I can operate the cmd key with my left thumb) whilst remaining compatible.&lt;/p&gt;</summary><category term="OSX"></category><category term="linux"></category></entry><entry><title>Tunneling to a remote machine via ssh</title><link href="https://mindriot101.github.io/blog/2011/04/08/tunneling-to-a-remote-machine-via-ssh/" rel="alternate"></link><updated>2011-04-08T13:57:00+02:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2011-04-08:blog/2011/04/08/tunneling-to-a-remote-machine-via-ssh/</id><summary type="html">&lt;p&gt;Update:¬†For the most part, I want to tunnel from the server to the local machine. This only works with the localhostname set to¬†localhost, for example to tunnel a mysql server to the current machine port 10101:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ssh -L 10101:localhost:3306 user@remoteserver.com -N
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The localhost is important, and in this case the mysql client (on the local machine) has to have the hostname set to¬†127.0.0.1¬†(for some reason localhost doesnt work).¬†
Ive been trying to access my works MySQL database from outside the universities firewall and was having issues. Im still having issues but thats another story: Ill get to that.
Some definitions: the local machine is my machine accessing the server from outside the firewall, and the server machine is the one running the server and is behind the firewall.
My initial test was to run a rails server (which runs on port 3000) on the server machine. It serves a basic test page just to show it works.¬†
To set up a tunnel, I used the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ssh -L localport:localhostname:remoteport user@remoteserver -N
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The -L means set up a tunnel, and -N means to not actually log in to the server. For this example I mapped port 3000 on the server machine to port 10101 on the local machine by running:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ssh -L 10101:hostname:3000 user@remoteserver -N
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then went to my web browser and typed localhost:10101 and got a simple rails start page. Et voila!&lt;/p&gt;
&lt;p&gt;&lt;img alt="ssh tunnel" src="{{" title="site.url }}/assets/images/ssh-tunnel.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;To access my MySQL server, this worked ok but the permissions for my username had to be altered as me@localhost (from the tunnel) could not access the databases owned by me@remoteserver due to the changing username. This is a separate issue so I will sort this out later!&lt;/p&gt;</summary><category term="ssh"></category><category term="linux"></category></entry><entry><title>Synergy</title><link href="https://mindriot101.github.io/blog/2010/12/18/synergy/" rel="alternate"></link><updated>2010-12-18T16:44:00+01:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2010-12-18:blog/2010/12/18/synergy/</id><summary type="html">&lt;p&gt;I have recently been playing with the &lt;a href="https://forums.macrumors.com/showthread.php?t=686540"&gt;Synergy&lt;/a&gt; software, which allows
a single mouse and keyboard to control multiple computers whatever
operating system they may be using. I am currently using my PC's mouse
and keyboard to write this on my macbook pro!&lt;/p&gt;
&lt;p&gt;It's pretty easy to set up, the windows server is pretty simple, the
only bit the documentation does not emphasise enough is that the screens
must be named after the hostname of the computer, so for widows it's the
'Computer name' and for OSX/linux it's the output of the 'hostname'
command. ¬†The linux and OSX client is command line only which is quite
annoying but otherwise a very nice piece of software.&lt;/p&gt;
&lt;p&gt;Oh and it's free!&lt;/p&gt;</summary><category term="synergy"></category><category term="linux"></category></entry><entry><title>Changing the rpath on a linux binary</title><link href="https://mindriot101.github.io/blog/2010/07/27/changing-the-rpath-on-a-linux-binary/" rel="alternate"></link><updated>2010-07-27T10:15:00+02:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2010-07-27:blog/2010/07/27/changing-the-rpath-on-a-linux-binary/</id><summary type="html">&lt;p&gt;&lt;a href="https://nixos.org/patchelf.html"&gt;PatchELF&lt;/a&gt; is a program that allows the patching of the rpath of a
linux binary to be whatever you want, even the printing of it.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;&lt;strong&gt;Short explanation:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Shared libraries are used in an operating system to allow the easy
updating of code and patch fixing to a large group of programs. With
static libraries, a patchfix to a library common to many programs would
force the recompilation of those programs. A fix to a shared library
could go on behind the scenes without these other programs even
realising (in the best case!).&lt;/p&gt;
&lt;p&gt;To accomodate for this functionality, shared libraries must be located
during runtime. There are three ways to do this (in order):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;System default paths&lt;/li&gt;
&lt;li&gt;The binaries &lt;em&gt;rpath&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;The &lt;em&gt;LD_LIBRARY_PATH&lt;/em&gt; enviroment variable&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Libraries found in stage 3 will override libraries found in stage 2 and
the same for 2-&gt;1. Because of this overriding, the &lt;em&gt;LD_LIBRARY_PATH&lt;/em&gt;
method is very dangerous, as the user can accidentally change this and
cause many programs to break.&lt;/p&gt;
&lt;p&gt;As far as the sysadmin is concerned, the best way to install new
software is to update the local database which contains the system
default paths, but for the developer who wishes to compile their own
programs, option 2 is the best.&lt;/p&gt;
&lt;p&gt;See my &lt;a href="{{ site.url }}/assets/Programming/linking-on-linux.md"&gt;previous post&lt;/a&gt; to see how to do this at compile time, but say
while developing a piece of software, you want to see what these paths
are or change them. This is where &lt;em&gt;PatchELF&lt;/em&gt; comes in handy. It allows
the printing of the &lt;em&gt;rpath&lt;/em&gt; variable or setting it to a completely new
location (eg. for testing against a custom version of the system
libraries).¬† It even allows the changing of the system default path
interpreter.&lt;/p&gt;
&lt;p&gt;For more information see &lt;a href="https://www.eyrie.org/~eagle/notes/rpath.html"&gt;this very informative post&lt;/a&gt;.&lt;/p&gt;</summary><category term="linux"></category><category term="c"></category></entry><entry><title>Linking on linux</title><link href="https://mindriot101.github.io/blog/2010/07/08/linking-on-linux/" rel="alternate"></link><updated>2010-07-08T15:24:00+02:00</updated><author><name>Simon Walker</name></author><id>tag:mindriot101.github.io,2010-07-08:blog/2010/07/08/linking-on-linux/</id><summary type="html">&lt;p&gt;I've just found out what some strange linking options mean with gcc!&lt;/p&gt;
&lt;p&gt;Quite often i've seen at the linking stage&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;gcc object.o -o executable.out -lsomelibrary -Wl,-rpath,somepath
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I've discovered that the -Wl,-rpath,somepath expands basically to&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;-Wl -rpath&lt;span class="o"&gt;=&lt;/span&gt;somepath
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and this means the location of the shared library in &lt;em&gt;somepath&lt;/em&gt; is hard
coded into the executable to be used at runtime. &lt;em&gt;rpath&lt;/em&gt; means runtime
path, all of which means the dangerous &lt;em&gt;LD_LIBRARY_PATH&lt;/em&gt; environment
variable is not needed.&lt;/p&gt;</summary><category term="linux"></category><category term="c"></category></entry></feed>